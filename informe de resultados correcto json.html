<html lang="es">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Informe de Resultados</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(180deg, #0A2A3E 0%, #1B4B5A 100%);
            color: #E0F7FA;
        }
        .card {
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.2));
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 16px;
            margin: 8px;
        }
        .highlight {
            background: linear-gradient(180deg, #00BCD4, #008C9E);
            border-radius: 8px;
            padding: 16px;
            margin: 8px;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body class="p-8">
    <div id="informe">
        <!-- El contenido del informe se generará dinámicamente aquí -->
    </div>

    <script>
        const datosInforme = {
          "periodo": {
            "inicio": "01 de agosto, 2023",
            "fin": "31 de julio, 2024"
          },
          "volumenTransacciones": 1250101.60,
          "beneficiosTotales": 94757.62,
          "rentabilidad": 37.9,
          "inversionInicial": 250020.32,
          "criptomonedasUsadas": [
            { "nombre": "USDT", "porcentaje": 40 },
            { "nombre": "BTC", "porcentaje": 25 },
            { "nombre": "ETH", "porcentaje": 15 },
            { "nombre": "BNB", "porcentaje": 10 },
            { "nombre": "ADA", "porcentaje": 5 },
            { "nombre": "Otras", "porcentaje": 5 }
          ],
          "beneficiosTrimestres": [
            { "trimestre": "Q1", "beneficio": 18951.52 },
            { "trimestre": "Q2", "beneficio": 23689.40 },
            { "trimestre": "Q3", "beneficio": 25585.56 },
            { "trimestre": "Q4", "beneficio": 26531.14 }
          ],
          "desgloseTransacciones": [
            { "tipo": "Compras", "cantidad": 3245, "valor": 725058.93 },
            { "tipo": "Ventas", "cantidad": 2890, "valor": 525042.67 },
            { "tipo": "Intercambios", "cantidad": 1123, "valor": 150000.00 }
          ],
          "rendimientoCriptomonedas": [
            { "criptomoneda": "BTC", "rendimiento": 42.5 },
            { "criptomoneda": "ETH", "rendimiento": 35.2 },
            { "criptomoneda": "BNB", "rendimiento": 28.7 },
            { "criptomoneda": "ADA", "rendimiento": 22.1 }
          ],
          "eventosDestacados": [
            "Lanzamiento exitoso de la estrategia de trading automático en octubre 2023, aumentando la eficiencia en un 15%.",
            "Incorporación de 3 nuevas criptomonedas al portafolio en enero 2024, diversificando las oportunidades de inversión.",
            "Implementación de un sistema de gestión de riesgos mejorado en marzo 2024, reduciendo las pérdidas potenciales en un 8%.",
            "Alcance del hito de $1 millón en volumen de transacciones en junio 2024."
          ]
        };

        // Función para generar el contenido del informe
        function generarInforme(datos) {
            const informe = document.getElementById('informe');
            informe.innerHTML = `
                <div class="flex flex-col md:flex-row justify-between items-center mb-4">
                    <div class="flex items-center mb-4 md:mb-0">
                        <svg class="mr-4" width="50" height="50" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                            <g>
                              <path class="st3" d="M111.52,35.13c22.72-14.11,52.57-7.13,66.68,15.59c14.11,22.72,7.13,52.57-15.59,66.68      c0,0-5.48,4.4-17.24,5.1l-0.16,11.06c30.51-2.2,50.38-23.54,50.38-56.52c0-32.98-26.73-59.71-59.71-59.71      c0,0-37.82-0.29-51.65,34.4l8.3,3.25C92.53,54.97,101.49,41.71,111.52,35.13z" fill="#FFFFFF"/>
                              <path class="st3" d="M15.06,65.54c0,0,42.61-36.45,99.31,3.13c56.5,51.07,11.28,112.78,11.28,112.78l-13.78-0.63     c0,0,49.6-55.87-5.95-104.64C53.49,33.69,4.41,88.73,4.41,88.73V18.93h56.9v9.39H14.75L15.06,65.54z" fill="#FFFFFF"/>
                              <path class="st3" d="M23.88,157.73c1.78,1.67,2.67,3.91,2.67,6.74c0,2.81-0.89,5.05-2.67,6.72c-1.78,1.67-3.84,2.5-6.17,2.5     h-3.42v9.15h-7.3v-27.61h10.73C20.04,155.23,22.1,156.06,23.88,157.73z M18.21,166.06c0.44-0.43,0.66-0.96,0.66-1.59     c0-0.63-0.22-1.16-0.66-1.6c-0.44-0.44-0.97-0.66-1.6-0.66h-2.33v4.5h2.33C17.24,166.71,17.78,166.49,18.21,166.06z" fill="#FFFFFF"/>
                              <path class="st3" d="M36.7,175.85h9.24v6.98H29.39v-27.61h7.3V175.85z" fill="#FFFFFF"/>
                              <path class="st3" d="M73.22,182.83h-7.49l-1.92-5.14h-8.34l-1.92,5.14h-7.47l10.12-27.61h6.89L73.22,182.83z M57.7,171.58h3.92     l-1.98-6.83L57.7,171.58z" fill="#FFFFFF"/>
                              <path class="st3" d="M93.47,170.34v-15.11h7.34v27.61h-6.64L82.2,167.72v15.11h-7.34v-27.61h6.64L93.47,170.34z" fill="#FFFFFF"/>
                            </g>
                          </svg>
                        <h1 class="text-3xl font-bold">INFORME DE RESULTADOS</h1>
                    </div>
                    <div class="text-right">
                        <button id="downloadBtn" class="bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-4 rounded inline-flex items-center">
                            <svg class="fill-current w-4 h-4 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                                <path d="M13 8V2H7v6H2l8 8 8-8h-5zM0 18h20v2H0v-2z"/>
                            </svg>
                            <span>Descargar PDF</span>
                        </button>
                    </div>
                </div>
                
                <div class="mb-4">
                    <p class="text-lg">
                        <span class="text-teal-400">Periodo:</span> ${datos.periodo.inicio} | ${datos.periodo.fin}
                    </p>
                </div>
                
                <div class="flex flex-col md:flex-row flex-wrap gap-4 mb-4">
                    <div class="highlight flex-1">
                        <p class="text-lg"><i class="fas fa-exchange-alt"></i> Volumen de Transacciones</p>
                        <p class="text-3xl font-bold">$${datos.volumenTransacciones.toLocaleString('es-ES', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</p>
                    </div>
                    <div class="card flex-1">
                        <p class="text-lg"><i class="fas fa-chart-line"></i> Beneficios Totales</p>
                        <p class="text-3xl font-bold">$${datos.beneficiosTotales.toLocaleString('es-ES', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</p>
                    </div>
                    <div class="card flex-1">
                        <p class="text-lg"><i class="fas fa-percentage"></i> % de Rentabilidad</p>
                        <p class="text-3xl font-bold">${datos.rentabilidad}%</p>
                    </div>
                </div>
                
                <div class="flex flex-col md:flex-row gap-4 mb-4">
                    <div class="card flex-1">
                        <p class="text-lg font-bold">Criptomonedas más usadas</p>
                        <canvas id="criptomonedasChart"></canvas>
                    </div>
                    <div class="card flex-1">
                        <p class="text-lg font-bold">Distribución de Beneficios</p>
                        <canvas id="beneficiosChart"></canvas>
                    </div>
                </div>
                
                <div class="card mb-4">
                    <h2 class="text-xl font-bold mb-4">Resumen de Resultados</h2>
                    <p>Durante el periodo del ${datos.periodo.inicio} al ${datos.periodo.fin}, se ha registrado un volumen de transacciones de $${datos.volumenTransacciones.toLocaleString('es-ES', {minimumFractionDigits: 2, maximumFractionDigits: 2})} USDT. Los beneficios totales alcanzaron $${datos.beneficiosTotales.toLocaleString('es-ES', {minimumFractionDigits: 2, maximumFractionDigits: 2})} USDT, lo que representa una rentabilidad del ${datos.rentabilidad}% sobre la inversión inicial de $${datos.inversionInicial.toLocaleString('es-ES', {minimumFractionDigits: 2, maximumFractionDigits: 2})} USDT.</p>
                    <p class="mt-2">Las criptomonedas más utilizadas en las operaciones fueron ${datos.criptomonedasUsadas.slice(0, 5).map(c => c.nombre).join(', ')}. La distribución de beneficios muestra una tendencia positiva a lo largo de los trimestres, con un notable aumento en el último trimestre del periodo.</p>
                </div>

                <div class="flex flex-col md:flex-row gap-4 mb-4">
                    <div class="card flex-1">
                        <h3 class="text-lg font-bold mb-2">Desglose de Transacciones</h3>
                        <table class="w-full">
                            <thead>
                                <tr>
                                    <th class="text-left">Tipo</th>
                                    <th class="text-right">Cantidad</th>
                                    <th class="text-right">Valor (USDT)</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${datos.desgloseTransacciones.map(t => `
                                    <tr>
                                        <td>${t.tipo}</td>
                                        <td class="text-right">${t.cantidad.toLocaleString('es-ES')}</td>
                                        <td class="text-right">${t.valor.toLocaleString('es-ES', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                    <div class="card flex-1">
                        <h3 class="text-lg font-bold mb-2">Rendimiento por Criptomoneda</h3>
                        <table class="w-full">
                            <thead>
                                <tr>
                                    <th class="text-left">Criptomoneda</th>
                                    <th class="text-right">Rendimiento (%)</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${datos.rendimientoCriptomonedas.map(r => `
                                    <tr>
                                        <td>${r.criptomoneda}</td>
                                        <td class="text-right">${r.rendimiento}%</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="card">
                    <h3 class="text-lg font-bold mb-2">Eventos Destacados</h3>
                    <ul class="list-disc pl-5">
                        ${datos.eventosDestacados.map(e => `<li>${e}</li>`).join('')}
                    </ul>
                </div>
            `;

            // Generar gráficos
            generarGraficos(datos);

            // Configurar el botón de descarga
            document.getElementById('downloadBtn').addEventListener('click', function() {
                var opt = {
                    margin: 1,
                    filename: 'informe_de_resultados.pdf',
                    image: { type: 'jpeg', quality: 0.98 },
                    html2canvas: { scale: 2 },
                    jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
                };
                html2pdf().set(opt).from(document.body).save();
            });
        }

        // Función para generar los gráficos
        function generarGraficos(datos) {
            // Gráfico de criptomonedas más usadas
            new Chart(document.getElementById('criptomonedasChart'), {
                type: 'pie',
                data: {
                    labels: datos.criptomonedasUsadas.map(c => c.nombre),
                    datasets: [{
                        data: datos.criptomonedasUsadas.map(c => c.porcentaje),
                        backgroundColor: ['#00BCD4', '#008C9E', '#006064', '#00ACC1', '#0097A7', '#B2EBF2']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                color: '#E0F7FA'
                            }
                        },
                        title: {
                            display: true,
                            text: 'Criptomonedas más usadas',
                            color: '#E0F7FA'
                        }
                    }
                }
            });

            // Gráfico de distribución de beneficios
            new Chart(document.getElementById('beneficiosChart'), {
                type: 'bar',
                data: {
                    labels: datos.beneficiosTrimestres.map(b => b.trimestre),
                    datasets: [{
                        label: 'Beneficios',
                        data: datos.beneficiosTrimestres.map(b => b.beneficio),
                        backgroundColor: '#00BCD4'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                color: '#E0F7FA'
                            }
                        },
                        title: {
                            display: true,
                            text: 'Distribución de Beneficios por Trimestre',
                            color: '#E0F7FA'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: '#E0F7FA'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        x: {
                            ticks: {
                                color: '#E0F7FA'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        }
                    }
                }
            });
        }

        // Generar el informe inmediatamente con los datos locales
        generarInforme(datosInforme);
    </script>
</body>
</html>
